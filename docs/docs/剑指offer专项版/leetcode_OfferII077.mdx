---
tags:
  - é“¾è¡¨
  - åŒæŒ‡é’ˆ
  - åˆ†æ²»
  - æ’åº
  - å½’å¹¶æ’åº
  - å‰‘æŒ‡offerä¸“é¡¹ç‰ˆ
id: leetcode_OfferII077
title: ğŸŸ¡ å‰‘æŒ‡ Offer II 077. é“¾è¡¨æ’åº
ques_id: OfferII077
platform: leetcode
online_link: https://leetcode-cn.com/problems/7WHec2/
online_name: é“¾è¡¨æ’åº
level: m
---

export const Highlight = ({children, color}) => (
  <span
    style={{
      backgroundColor: color,
      borderRadius: '2px',
      color: '#fff',
      padding: '0.2rem',
    }}>
    {children}
  </span>
);

:::tip LeetCode æç¤º

é¢˜ç›®éš¾åº¦ <Highlight color="#ffc01e">ä¸­ç­‰(æˆ‘è§‰å¾—æ˜¯å›°éš¾)</Highlight>

åŸé¢˜é“¾æ¥ [ğŸ”— leetcode](https://leetcode-cn.com/problems/7WHec2/)

:::

## é¢˜è§£1

å›°éš¾ä¹‹å¤„è¿˜æ˜¯åœ¨äºèŠ‚ç‚¹æ€ä¹ˆæ–­ã€æ€ä¹ˆè¿ã€‚

åˆå¹¶é“¾è¡¨æ€è·¯æ˜¯äºŒåˆ†æ³•ã€‚äºŒåˆ†æ³•ä¹Ÿæœ‰ä¸¤ç§åˆ†æ²»æ€è·¯ï¼Œä¸€ç§æ˜¯ç”¨é€’å½’ï¼Œæ¯æ¬¡æ‰¾åˆ°ä¸­ç‚¹ï¼ŒæŠŠå‰åä¸¤æ®µåˆ†åˆ«å†æ’åº&mergeã€‚

ä¸€ç§æ˜¯ä»å‰å¾€åè¾¹èµ°è¾¹mergeï¼Œè¿™æ ·å¯ä»¥è¾¾åˆ°å¸¸æ•°å­˜å‚¨ç©ºé—´çš„è¦æ±‚ï¼Œä½†æ˜¯è£å‰ªå°±ç»•äº†ä¸€ç‚¹ã€‚

ä¸‹é¢æ˜¯è¿«ä¸å¾—å·²æŠ„çš„ç­”æ¡ˆã€‚å…³é”®åœ¨äºï¼Œprevå¦‚ä½•è¿æ¥ä¸‹ä¸€æ®µçš„å¤´ï¼Ÿå®é™…ä¸Šæ˜¯è¿™æ¬¡éå†ä¸ç”¨ç®¡ï¼ŒæŠŠprevç§»åˆ°è¿™æ¬¡éå†çš„é˜Ÿå°¾å³å¯ï¼Œè®©ä¸‹ä¸€æ¬¡éå†æ¥ä¸Šã€‚

```java
/**
 * Definition for singly-linked list.
 * public class ListNode {
 *     int val;
 *     ListNode next;
 *     ListNode() {}
 *     ListNode(int val) { this.val = val; }
 *     ListNode(int val, ListNode next) { this.val = val; this.next = next; }
 * }
 */
class Solution {
    public ListNode sortList(ListNode head) {
        if (head == null) {
            return null;
        }
        ListNode dummy = new ListNode(0, head);
        ListNode prev, next, cur = head, h1, h2;

        int k = 0;
        while (cur != null) {
            k += 1;
            cur = cur.next;
        }

        for (int subLength = 1; subLength <= k; subLength *= 2) {
            prev = dummy; cur = dummy.next;
            while (cur != null) {
                h1 = cur;

                for (int i=1; i<subLength && cur.next != null; i+=1) {
                    cur = cur.next;
                }
                h2 = cur.next;
                cur.next = null;
                cur = h2;

                for (int i=1; i<subLength && cur != null && cur.next != null; i+=1) {
                    cur = cur.next;
                }
                next = null;
                if (cur != null) {
                    next = cur.next;
                    cur.next = null;
                }
                ListNode mergeHead = mergeList(h1, h2);
                prev.next = mergeHead;
                while (prev.next != null) {
                    prev = prev.next;
                }
                cur = next;
            }
        }

        return dummy.next;
    }

    public ListNode mergeList(ListNode h1, ListNode h2) {
        ListNode dummy = new ListNode();
        dummy.next = h1;
        ListNode cur = dummy, p;
        while (h1 != null && h2 != null) {
            if (h1.val > h2.val) {
                p = h2.next;
                h2.next = null;
                cur.next = h2;
                h2 = p;
            } else {
                p = h1.next;
                h1.next = null;
                cur.next = h1;
                h1 = p;
            }
            cur = cur.next;
        }
        if (h1 != null) {
            cur.next = h1;
        }
        if (h2 != null) {
            cur.next = h2;
        }
        return dummy.next;
    }
}
```
